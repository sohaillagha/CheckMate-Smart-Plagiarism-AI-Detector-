Medical Imaging with Deep Learning 2022 Short Paper – MIDL 2022 Predicting Thrombectomy Recanalization from CT Imaging Using Deep Learning Models Haoyue Zhang∗1,2 HaoyueZhang@mednet.ucla.edu Jennifer S Polson∗1,2 jpolson@g.ucla.edu Eric J Yang1 EricJYang@ucla.edu Kambiz Nael3 kanael@mednet.ucla.edu William Speier1,3 Speier@ucla.edu Corey W. Arnold1,2,3,4 cwarnold@ucla.edu 1 Computational Diagnostics Lab, University of California, Los Angeles, CA 90024 USA 2 Department of Bioengineering, University of California, Los Angeles, CA 90024 USA 3 Department of Radiology, University of California, Los Angeles, CA 90024, USA 4 Department of Pathology, University of California, Los Angeles, CA 90024, USA Editors: Accepted for publication at MIDL 2022 Abstract For acute ischemic stroke (AIS) patients with large vessel occlusions, clinicians must de- cide if the benefit of mechanical thrombectomy (MTB) outweighs the risks and potential complications following an invasive procedure. Pre-treatment computed tomography (CT) and angiography (CTA) are widely used to characterize occlusions in the brain vasculature. If a patient is deemed eligible, a modified treatment in cerebral ischemia (mTICI) score will be used to grade how well blood flow is reestablished throughout and following the MTB procedure. An estimation of the likelihood of successful recanalization can support treatment decision-making. In this study, we proposed a fully automated prediction of a patient’s recanalization score using pre-treatment CT and CTA imaging. We designed a spatial cross attention network (SCANet) that utilizes vision transformers to localize to pertinent slices and brain regions. Our top model achieved an average cross-validated ROC-AUC of 77.33 ± 3.9%. This is a promising result that supports future applications of deep learning on CT and CTA for the identification of eligible AIS patients for MTB. Keywords: Acute Ischemic Stroke, Computed Tomography, Deep Learning, Vision Trans- formers 1. Introduction Stroke is the fifth leading cause of death and the leading cause of long-term disability; of the 795,000 new and recurrent strokes each year, acute ischemic stroke (AIS) accounts for 87% of cases (Tsao et al., 2022). Mechanical thrombectomy (MTB) is the leading treatment for patients with clots in large blood vessels. In this procedure, a blood clot is surgically removed from an artery to achieve recanalization, i.e., restored blood flow. As a standard measurement for recanalization achieved, a modified treatment in cerebral ischemia (mTICI) score (Tomsick, 2007) is assigned to patients post-treatment. This post-treatment score is clinically significant, as it has been shown that favorable scores, i.e., mTICI 2c or greater, are associated with better clinical outcomes in the long term (´Angel Chamorro et al., 2017). ∗Haoyue Zhang and Jennifer S Polson contributed equally. © 2022 H. Zhang, J.S. Polson, E.J. Yang, K. Nael, W. Speier & C.W. Arnold. arXiv:2302.04143v2 [eess.IV] 17 Apr 2024 Zhang Polson Yang Nael Speier Arnold Figure 1: Overview of the proposed deep learning architecture. The figure details the entire architecture, neighborhood branch modules, spatial attention transformer module (SAT), and cross attention transformer module (CAT). Unfavorable scores (mTICI less than 2c) indicate that the treatment did not effectively clear the blood vessel. Imaging has been identified as one modality to illustrate patient physiology that could influence the likelihood of a successful MTB procedure. Predicting final mTICI score prior to a procedure can provide doctors and with more more information when considering treatment options. Deep learning has been shown to leverage the amount of detail in images to improve prediction accuracy (LeCun et al., 2015). Current literature presents models that perform semi-automated prediction of mTICI score based on pre- treatment CT imaging, with inconsistent performance (Hilbert et al., 2019; Siddiqui et al., 2021). We propose a fully automated model that uses both CT and CTA images to predict mTICI score post-treatment, incorporating attention modules into a deep learning network to effectively localize to informative stroke regions without requiring manual segmentation. 2. Data and Methods The cohort used for this study comprises patients treated from 2012-2019. A patient was included in the cohort if they had CT and CTA imaging, underwent thrombectomy for stroke, and were assigned an mTICI score post-MTB. Of the 254 eligible patients, 69 patients were excluded due to missing either CT or CTA series, and 8 were excluded to due unclear stroke location, leaving 177 patients total. The dataset matched demographic distributions seen in other stroke studies, and the target labels were approximately balanced. Patient images were processed using a previously published pipeline adapted for CT, which included brain extraction and registration to a CT template in MNI space (Zhang et al., 2021b). Utilizing a ResNet backbone, CT and CTA images were used as a slice-wise input (input size 26x224x224) for a global 2D convolutional block, chosen because of the large slice thickness found in stroke protocols (He et al., 2016). The outputs from neighboring slices were then fed into ResNet34-based branches that shared weights across slice neighborhoods. The model leveraged two versions of transformer attention modules. A spatial attention transformer (SAT) utilized multi-head attention on each slice to focus on salient regions (Dosovitskiy et al., 2021). Within each neighborhood branch, a cross attention transformer (CAT) identified important slices. Finally, the branch outputs were subjected to a weighted softmax layer to ultimately generate binary predictions. The architecture and modules are 2 Predicting Thrombectomy Recanalization from Admission CT Imaging Using Deep Learning Models summarized in Figure 1. The model was trained for 200 epochs with early stopping, using the Adam optimizer with weight decay, a batch size of 12, and a learning rate of 0.0001. Model ROC-AUC Accuracy Precision Sensitivity Specificity Siddiqui et al. 0.717 – – – – Hilber et al. 0.65 ± 0.10 – – – – Radiomics 0.6859 ± 0.043 0.6877 ± 0.039 0.6417 ± 0.068 0.7425 ± 0.123 0.6421 ± 0.126 ResNet34 0.5840 ± 0.036 0.5656 ± 0.046 0.5410 ± 0.067 0.8500 ± 0.300 0.3253 ± 0.296 SCANet 0.7732 ± 0.039 0.7523 ± 0.042 0.7424 ± 0.145 0.8250 ± 0.174 0.6905 ± 0.215 Table 1: Performance of our current model benchmarked against results from literature as well as previously published models applied to this cohort (Hilbert et al., 2019; Siddiqui et al., 2021). 3. Results and Discussion The results of our experiments are summarized in Table 1. The average ROC-AUC achieved by SCANet was 0.7732 ± 0.039. This is a significant improvement over the previously published fully automatic deep learning model(Siddiqui et al., 2021). Our method also demonstrates higher and more robust performance metrics than the state-of-the-art model requiring manual clot segmentation (Hilbert et al., 2019). In addition to the literature benchmarks, SCANet performs better than a radiomics-based model and standard deep learning architecture when trained on the same cohort (Zhang et al., 2021a). Clinicians decide to perform MTB based on likelihood of successful recanalization, but it is unknown what factors underlie MTB responses. Clinical images such as CT and CTA contain valuable information to predict procedure outcome, and deep learning models have the capability to learn representations from highly dimensional imaging data. This study sought to predict final MTB recanalization in a fully automatic manner, leveraging re- cent advances in vision transformers to localize to the stroke region. We showed that our proposed model outperforms prior fully- and semi-automated machine and deep learning models. The primary limitation of our study is the small sample size, which precludes more robust validation. A few future directions include experimenting on a larger dataset across several institutions, optimizing the preprocessing pipeline to more effectively preserve high resolution CTA, and correlation of the immediate treatment response with long-term out- comes. These steps can produce a model that more accurately predicts MTB recanalization, in turn helping doctors and patients in the treatment decision process. References Alexey Dosovitskiy et al. An image is worth 16x16 words: Transformers for image recognition at scale. ICLR, 2021. Kaiming He et al. Deep residual learning for image recognition. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 770–778, 2016. Adam Hilbert et al. Data-efficient deep learning of radiological image data for outcome prediction after endovascular treatment of patients with acute ischemic stroke. Computers in Biology and Medicine, 115:103516, 2019. Yann LeCun, Yoshua Bengio, and Geoffrey Hinton. Deep learning. Nature, 521(7553):436–444, 2015. Fazeel M Siddiqui et al. Quantitative assessment of hyperdense sign measured by hounsfield units is associated with unsuccessful mechanical thrombectomy. Clinical Neuroradiology, 31(4):1111–1119, 2021. Thomas A. Tomsick. Timi, tibi, tici: I came, i saw, i got confused. American Journal Of Neuroradiology, 28(2):382–384, 2007. Connie W. Tsao et al. Heart disease and stroke statistics-2022 update: A report from the american heart association. Circulation, 145 (8):e391–e426, 2022. Haoyue Zhang et al. A machine learning approach to predict acute ischemic stroke thrombectomy reperfusion using discriminative mr image features. In 2021 IEEE EMBS International Conference on Biomedical and Health Informatics (BHI), pages 1–4, 2021a. Haoyue Zhang et al. Intra-domain task-adaptive transfer learning to determine acute ischemic stroke onset time. Computerized Medical Imaging and Graphics, 90:101926, 2021b. ´Angel Chamorro et al. Complete reperfusion is required for maximal benefits of mechanical thrombectomy in stroke patients. Scientific Reports, 7(1):11636, 2017. 3